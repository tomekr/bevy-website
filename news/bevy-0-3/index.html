







<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name='viewport' content="width=device-width, initial-scale=1" />
        <meta property="og:title" content="Bevy - Bevy 0.3" />
        <meta property="og:type" content="website" />
        <meta property="og:url" content="https://bevyengine.org&#x2F;&#x2F;news&#x2F;bevy-0-3&#x2F;" />
        <meta property="og:image" content="https://bevyengine.org/assets/bevy_logo_fill.png" />
        <meta property="og:description" content="Bevy is a refreshingly simple data-driven game engine built in Rust. It is free and open-source forever!" />
        <link rel="shortcut icon" type="image/png" href="/assets/favicon.png">
        <link rel="stylesheet" href="/site.css" />
        <link href="/atom.xml" rel="alternate" type="application/atom+xml" />
        <title>Bevy - Bevy 0.3</title>
         
    </head>

    <body>
        <div class="headerbar-container">
            <nav class="headerbar container">
                <a href="/" class="header-logo">
                    <img src="/assets/bevy_logo_dark.svg" class="logo" alt="bevy logo" />
                </a>
                
                    <a href="/" class="header-logo-mobile">
                        <img src="/assets/bevy_icon_dark.svg" class="logo" alt="bevy icon" />
                    </a>
                
                <div class="header-item header-message">
                    
                        News
                    
                </div>
                <div class="header-item header-push"></div>
                



    


<a href="&#x2F;" class="header-item" >
    Features
</a>

                



    


<a href="&#x2F;learn" class="header-item" >
    Learn
</a>

                



    


<a href="&#x2F;news" class="header-item header-item-active"  >
    News
</a>

                



    


<a href="&#x2F;community" class="header-item" >
    Community
</a>

                <a class="header-item header-button header-button-donate" href="https://github.com/sponsors/cart">Donate <img src="/assets/heart.svg" class="header-button-donate-heart" alt="heart icon"/></a>
                <a class="header-item header-button" href="/learn/book/getting-started/">Get Started</a>
            </nav>
        </div>
        <section class="section">
            <div class="container">
                
<div class="padded-content">
  <h1 class="news-title">
    Bevy 0.3
  </h1>
  <h2 class="news-subtitle">Written on November 03, 2020 by Carter Anderson
    
    <span class="news-social-links">
      (
      
      <img src="/assets/github_grey.svg" class="news-social-icon" /><span class="media-content">
        <a class="news-social-link"
          href="https://www.github.com/cart">@cart</a></span>
      
      
      <img src="/assets/twitter_grey.svg" class="news-social-icon" />
      <span class="media-content">
        <a class="news-social-link"
          href="https://www.twitter.com/cart_cart">@cart_cart</a>
      </span>
      
      
      <img src="/assets/youtube_grey.svg" class="news-social-icon" />
      <span class="media-content">
        <a class="news-social-link"
          href="https://www.youtube.com/cartdev">cartdev</a>
      </span>
      
      )
    </span>
    
  </h2>
  
  <div class="media-content news-content">
    <img src="sheep_game.png" />
    
      
      <div class="news-image-subtitle"><a href="https:&#x2F;&#x2F;twitter.com&#x2F;schneckerstein&#x2F;status&#x2F;1309491121555410945">Sheep Game by @schneckerstein</a></div>
      
    
  </div>
  
  <div class="media-content news-content"><p>A little over a month after releasing Bevy 0.2, and thanks to <strong>59</strong> contributors, <strong>122</strong> pull requests, and our <a href="https://github.com/sponsors/cart"><strong>generous sponsors</strong></a>, I'm happy to announce the <strong>Bevy 0.3</strong> release on <a href="https://crates.io/crates/bevy">crates.io</a>!</p>
<p>For those who don't know, Bevy is a refreshingly simple data-driven game engine built in Rust. You can check out <a href="/learn/book/getting-started/">Quick Start Guide</a> to get started. Bevy is also free and open source forever! You can grab the full <a href="https://github.com/bevyengine/bevy">source code</a> on GitHub.</p>
<p>Here are some of the highlights from this release:</p>
<span id="continue-reading"></span><h2 id="initial-android-support">Initial Android Support</h2>
<div class="release-feature-authors">authors: @enfipy, @PrototypeNM1, @endragor, @naithar</div>
<p>You can try out the <a href="https://github.com/bevyengine/bevy/tree/v0.3.0/examples/android">Bevy Android example</a> by following the <a href="https://github.com/bevyengine/bevy/blob/v0.3.0/examples/README.md#android">instructions here</a>. While many things work, please note that this is <em>very hot</em> off the presses. Some features will work and others probably won't. Now is a great time to dive in and help us close the gaps!</p>
<p><img src="https://bevyengine.org/news/bevy-0-3/android.png" alt="android" /></p>
<p>This was a massive group effort that spanned multiple projects:</p>
<ul>
<li>Bevy: rewrote bevy-glsl-to-spirv to support android / static libraries (@PrototypeNM1, @enfipy)</li>
<li>Bevy: <code>bevy_asset</code> backend using Android Asset Manager (@enfipy)</li>
<li>Bevy: Touch support (@naithar)</li>
<li>Bevy: Texture format fix (@enfipy)</li>
<li>Bevy: UI touch fixes, touch force, and android example (@enfipy)</li>
<li>Cpal: android audio support (@endragor) </li>
<li>android-ndk-rs / cargo-apk: fix to support Bevy project structure (@PrototypeNM1)</li>
</ul>
<h2 id="initial-ios-support">Initial iOS Support</h2>
<div class="release-feature-authors">authors: @simlay, @MichaelHills, @Dash-L, @naithar</div>
<p>Bevy can now run on iOS!</p>
<img src="ios.png" style="margin-left: -4rem; margin-bottom: -5rem; margin-top: -3rem" />
<p>You can try out the <a href="https://github.com/bevyengine/bevy/tree/v0.3.0/examples/ios">Bevy iOS example</a> by following the <a href="https://github.com/bevyengine/bevy/tree/v0.3.0/examples#ios">instructions here</a>. This one is also hot off the presses: some features will work and others probably won't.</p>
<p>This was another large group effort that spanned multiple projects:</p>
<ul>
<li>Bevy: XCode Project / Example (@simlay with help from @MichaelHills)</li>
<li>Bevy: Runtime shader compilation using shaderc (@MichaelHills)</li>
<li>Bevy: Rodio upgrade (@Dash-L)</li>
<li>Bevy: Touch support (@naithar)</li>
<li>Winit: Fix iOS portrait view (@MichaelHills) </li>
<li>RustAudio: iOS support (@simlay and @MichaelHills)</li>
</ul>
<p>Known issues:</p>
<ul>
<li><a href="https://github.com/RustAudio/cpal/pull/485">Audio doesn't quite work yet</a></li>
</ul>
<h2 id="wasm-asset-loading">WASM Asset Loading</h2>
<div class="release-feature-authors">authors: @mrk-its (and ported to the new AssetIo by @cart)</div>
<p>@mrk-its has been hard at work on expanding Bevy's WASM support. In this release we landed WASM asset loading. You can now load assets when you publish to WASM just like you would on any other platform:</p>
<pre style="background-color:#2b2c2f;">
<code class="language-rust" data-lang="rust"><span style="color:#cccece;">asset_server</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">load</span><span style="color:#5fb3b3;">(&quot;</span><span style="color:#99c794;">sprite.png</span><span style="color:#5fb3b3;">&quot;);
</span></code></pre>
<p>If the asset hasn't already been loaded, this will make a <code>fetch()</code> request to retrieve the asset over HTTP.</p>
<p>@mrk-its has also been building a custom WebGL2 <code>bevy_render</code> backend. It is already pretty usable, but its not <em>quite</em> ready yet. Expect more news on this soon!</p>
<h2 id="touch-input">Touch Input</h2>
<div class="release-feature-authors">authors: @naithar</div>
<p>Bevy now has support for touches:</p>
<pre style="background-color:#2b2c2f;">
<code class="language-rust" data-lang="rust"><span style="color:#c594c5;">fn </span><span style="color:#6699cc;">touch_system</span><span style="color:#5fb3b3;">(</span><span style="color:#f99157;">touches</span><span style="color:#5fb3b3;">: </span><span style="color:#cccece;">Res</span><span style="color:#5fb3b3;">&lt;</span><span style="color:#cccece;">Touches</span><span style="color:#5fb3b3;">&gt;) {
    </span><span style="color:#5f6364;">// you can iterate all current touches and retrieve their state like this:
    </span><span style="color:#c594c5;">for</span><span style="color:#cccece;"> touch </span><span style="color:#5fb3b3;">in</span><span style="color:#cccece;"> touches</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">iter</span><span style="color:#5fb3b3;">() {
        </span><span style="color:#cccece;">println!</span><span style="color:#5fb3b3;">(&quot;</span><span style="color:#99c794;">active touch: {:?}</span><span style="color:#5fb3b3;">&quot;,</span><span style="color:#cccece;"> touch</span><span style="color:#5fb3b3;">);
    }

    </span><span style="color:#c594c5;">for</span><span style="color:#cccece;"> touch </span><span style="color:#5fb3b3;">in</span><span style="color:#cccece;"> touches</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">iter_just_pressed</span><span style="color:#5fb3b3;">() {
        </span><span style="color:#cccece;">println!</span><span style="color:#5fb3b3;">(&quot;</span><span style="color:#99c794;">just pressed {:?}</span><span style="color:#5fb3b3;">&quot;,</span><span style="color:#cccece;"> touch</span><span style="color:#5fb3b3;">);
    }

    </span><span style="color:#c594c5;">for</span><span style="color:#cccece;"> touch </span><span style="color:#5fb3b3;">in</span><span style="color:#cccece;"> touches</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">iter_just_released</span><span style="color:#5fb3b3;">() {
        </span><span style="color:#cccece;">println!</span><span style="color:#5fb3b3;">(&quot;</span><span style="color:#99c794;">just released {:?}</span><span style="color:#5fb3b3;">&quot;,</span><span style="color:#cccece;"> touch</span><span style="color:#5fb3b3;">);
    }

    </span><span style="color:#c594c5;">for</span><span style="color:#cccece;"> touch </span><span style="color:#5fb3b3;">in</span><span style="color:#cccece;"> touches</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">iter_just_cancelled</span><span style="color:#5fb3b3;">() {
        </span><span style="color:#cccece;">println!</span><span style="color:#5fb3b3;">(&quot;</span><span style="color:#99c794;">just cancelled {:?}</span><span style="color:#5fb3b3;">&quot;,</span><span style="color:#cccece;"> touch</span><span style="color:#5fb3b3;">);
    }
}
</span></code></pre>
<p>You can also consume raw touch events using the <code>Events&lt;TouchInput&gt;</code> resource.</p>
<h2 id="asset-system-improvements">Asset System Improvements</h2>
<div class="release-feature-authors">authors: @cart</div>
<h3 id="asset-handle-reference-counting">Asset Handle Reference Counting</h3>
<p>Assets are now automatically freed when their &quot;handle reference count&quot; reaches zero. This means you no longer need to think about freeing assets manually:</p>
<pre style="background-color:#2b2c2f;">
<code class="language-rust" data-lang="rust"><span style="color:#5f6364;">// Calling load() now returns a strong handle:
</span><span style="color:#c594c5;">let</span><span style="color:#cccece;"> handle </span><span style="color:#5fb3b3;">=</span><span style="color:#cccece;"> asset_server</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">load</span><span style="color:#5fb3b3;">(&quot;</span><span style="color:#99c794;">sprite.png</span><span style="color:#5fb3b3;">&quot;);

</span><span style="color:#5f6364;">// Note that you no longer need to unwrap() loaded handles. Ergonomics for the win!

// Cloning a handle increases the reference count by one
</span><span style="color:#c594c5;">let</span><span style="color:#cccece;"> second_handle </span><span style="color:#5fb3b3;">=</span><span style="color:#cccece;"> handle</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">clone</span><span style="color:#5fb3b3;">();

</span><span style="color:#5f6364;">// Spawn a sprite and give it our handle
</span><span style="color:#cccece;">commands</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">spawn</span><span style="color:#5fb3b3;">(</span><span style="color:#cccece;">SpriteComponents </span><span style="color:#5fb3b3;">{
</span><span style="color:#cccece;">    material</span><span style="color:#5fb3b3;">:</span><span style="color:#cccece;"> materials</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">add</span><span style="color:#5fb3b3;">(</span><span style="color:#cccece;">handle</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">into</span><span style="color:#5fb3b3;">()),
    ..</span><span style="color:#fac863;">Default</span><span style="color:#5fb3b3;">::</span><span style="color:#cccece;">default</span><span style="color:#5fb3b3;">()
});

</span><span style="color:#5f6364;">// Later in some other system:
</span><span style="color:#cccece;">commands</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">despawn</span><span style="color:#5fb3b3;">(</span><span style="color:#cccece;">sprite_entity</span><span style="color:#5fb3b3;">);

</span><span style="color:#5f6364;">// There are no more active handles to &quot;sprite.png&quot;, so it will be freed before the next update
</span></code></pre><h3 id="asset-loaders-can-now-load-multiple-assets">Asset Loaders can now load multiple assets</h3>
<p>In past releases, <code>AssetLoaders</code> could only produce a single asset of a single type. In <strong>Bevy 0.3</strong>, they can now produce any number of assets for any type. The old behavior was extremely limiting when loading assets like GLTF files, which might produce many meshes, textures, and scenes. </p>
<h3 id="sub-asset-loading">Sub-Asset Loading</h3>
<p>Sometimes you only want to load a specific asset from an asset source. You can now load sub assets like this:</p>
<pre style="background-color:#2b2c2f;">
<code class="language-rust" data-lang="rust"><span style="color:#5f6364;">// Mesh0/Primitive0 references the first mesh primitive in &quot;my_scene.gltf&quot;
</span><span style="color:#c594c5;">let</span><span style="color:#cccece;"> mesh </span><span style="color:#5fb3b3;">=</span><span style="color:#cccece;"> asset_server</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">load</span><span style="color:#5fb3b3;">(&quot;</span><span style="color:#99c794;">my_scene.gltf#Mesh0/Primitive0</span><span style="color:#5fb3b3;">&quot;);
</span></code></pre><h3 id="assetio-trait">AssetIo Trait</h3>
<p>The <code>AssetServer</code> is now backed by the <code>AssetIo</code> trait. This allows us to load assets from whatever storage we want. This means on desktop we now load from the filesystem, on Android we use the Android Asset Manager, and on the web we make HTTP requests using the <code>fetch()</code> api.</p>
<h3 id="asset-dependencies">Asset Dependencies</h3>
<p>Assets can now depend on other assets, which will automatically be loaded when the original asset is loaded. This is useful when loading something like a &quot;scene&quot; which might reference other asset sources. We utilize this in our new GLTF loader.</p>
<h3 id="removed-assetserver-load-sync">Removed AssetServer::load_sync()</h3>
<p>This might rustle some feathers, but <code>AssetServer::load_sync()</code> had to go! This api wasn't WASM friendly, encouraged users to block game execution for the sake of convenience (which causes &quot;hitching&quot;), and was incompatible with the new AssetLoader api. Asset loading is now always asynchronous. Users of <code>load_sync()</code> should instead <code>load()</code> their assets, check load status in their systems, and change game state accordingly. </p>
<h2 id="gltf-scene-loader">GLTF Scene Loader</h2>
<div class="release-feature-authors">authors: @cart</div>
<p>Up until this point, the GLTF loader was painfully limited. It could only load the first mesh with a single texture in a GLTF file. For <strong>Bevy 0.3</strong>, we took advantage of the asset system improvements to write a new <code>GltfLoader</code> that loads GLTF files as Bevy <code>Scenes</code>, along with all meshes and textures in the files.</p>
<p>Here's Bevy loading the Khronos Flight Helmet example, which consists of multiple meshes and textures!</p>
<p><img src="https://bevyengine.org/news/bevy-0-3/flight_helmet.png" alt="flight helmet" /></p>
<p>Here is the complete code for a system that loads a GLTF file and spawns it as a scene:</p>
<pre style="background-color:#2b2c2f;">
<code class="language-rust" data-lang="rust"><span style="color:#c594c5;">fn </span><span style="color:#6699cc;">load_gltf_system</span><span style="color:#5fb3b3;">(</span><span style="color:#c594c5;">mut </span><span style="color:#f99157;">commands</span><span style="color:#5fb3b3;">:</span><span style="color:#cccece;"> Commands, </span><span style="color:#f99157;">asset_server</span><span style="color:#5fb3b3;">: </span><span style="color:#cccece;">Res</span><span style="color:#5fb3b3;">&lt;</span><span style="color:#cccece;">AssetServer</span><span style="color:#5fb3b3;">&gt;) {
    </span><span style="color:#c594c5;">let</span><span style="color:#cccece;"> scene_handle </span><span style="color:#5fb3b3;">=</span><span style="color:#cccece;"> asset_server</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">load</span><span style="color:#5fb3b3;">(&quot;</span><span style="color:#99c794;">models/FlightHelmet/FlightHelmet.gltf</span><span style="color:#5fb3b3;">&quot;);
</span><span style="color:#cccece;">    commands</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">spawn_scene</span><span style="color:#5fb3b3;">(</span><span style="color:#cccece;">scene_handle</span><span style="color:#5fb3b3;">);
}
</span></code></pre><h2 id="bevy-ecs-improvements">Bevy ECS Improvements</h2>
<div class="release-feature-authors">authors: @cart</div>
<h3 id="query-ergonomics">Query Ergonomics</h3>
<p>In this release I finally was able to remove the one thing I <em>truly despised</em> in Bevy ECS. In previous versions of Bevy, iterating over the components in a <code>Query</code> looked like this:</p>
<pre style="background-color:#2b2c2f;">
<code class="language-rust" data-lang="rust"><span style="color:#c594c5;">for </span><span style="color:#5fb3b3;">(</span><span style="color:#cccece;">a</span><span style="color:#5fb3b3;">,</span><span style="color:#cccece;"> b</span><span style="color:#5fb3b3;">) in &amp;</span><span style="color:#c594c5;">mut</span><span style="color:#cccece;"> query</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">iter</span><span style="color:#5fb3b3;">() {
    </span><span style="color:#5f6364;">// The `&amp;mut` here just felt so unnatural
</span><span style="color:#5fb3b3;">}

</span><span style="color:#5f6364;">// Or if you preferred you could do this
</span><span style="color:#c594c5;">for </span><span style="color:#5fb3b3;">(</span><span style="color:#cccece;">a</span><span style="color:#5fb3b3;">,</span><span style="color:#cccece;"> b</span><span style="color:#5fb3b3;">) in</span><span style="color:#cccece;"> query</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">iter</span><span style="color:#5fb3b3;">().</span><span style="color:#6699cc;">iter</span><span style="color:#5fb3b3;">() {
    </span><span style="color:#5f6364;">// query.iter().iter()? Really???
</span><span style="color:#5fb3b3;">}
</span></code></pre>
<p>Similarly, retrieving a specific entity's component's looked like this:</p>
<pre style="background-color:#2b2c2f;">
<code class="language-rust" data-lang="rust"><span style="color:#c594c5;">if let </span><span style="color:#fac863;">Ok</span><span style="color:#5fb3b3;">(</span><span style="color:#c594c5;">mut</span><span style="color:#cccece;"> result</span><span style="color:#5fb3b3;">) =</span><span style="color:#cccece;"> query</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">entity</span><span style="color:#5fb3b3;">(</span><span style="color:#cccece;">entity</span><span style="color:#5fb3b3;">) {
    </span><span style="color:#c594c5;">if let </span><span style="color:#fac863;">Some</span><span style="color:#5fb3b3;">((</span><span style="color:#cccece;">a</span><span style="color:#5fb3b3;">,</span><span style="color:#cccece;"> b</span><span style="color:#5fb3b3;">)) =</span><span style="color:#cccece;"> result</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">get</span><span style="color:#5fb3b3;">() {
        </span><span style="color:#5f6364;">// access components here
    </span><span style="color:#5fb3b3;">}
}
</span></code></pre>
<p>In <strong>Bevy 0.3</strong> you can just do this:</p>
<pre style="background-color:#2b2c2f;">
<code class="language-rust" data-lang="rust"><span style="color:#5f6364;">// iteration
</span><span style="color:#c594c5;">for </span><span style="color:#5fb3b3;">(</span><span style="color:#cccece;">a</span><span style="color:#5fb3b3;">,</span><span style="color:#cccece;"> b</span><span style="color:#5fb3b3;">) in</span><span style="color:#cccece;"> query</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">iter</span><span style="color:#5fb3b3;">() {
    </span><span style="color:#5f6364;">// sweet ergonomic bliss
</span><span style="color:#5fb3b3;">}

</span><span style="color:#5f6364;">// entity lookup
</span><span style="color:#c594c5;">if let </span><span style="color:#fac863;">Ok</span><span style="color:#5fb3b3;">((</span><span style="color:#cccece;">a</span><span style="color:#5fb3b3;">,</span><span style="color:#cccece;">b</span><span style="color:#5fb3b3;">)) =</span><span style="color:#cccece;"> query</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">get</span><span style="color:#5fb3b3;">(</span><span style="color:#cccece;">entity</span><span style="color:#5fb3b3;">) {
    </span><span style="color:#5f6364;">// boilerplate be gone!
</span><span style="color:#5fb3b3;">}
</span></code></pre>
<p>You might naturally be thinking something like:</p>
<p><em>Why did this take so long? Why would removing a single <code>&amp;mut</code> be hard?</em></p>
<p>It's a long story! In summary:</p>
<ul>
<li>The old api looked the way it did for a reason. It was the result of good design choices that protect against unsafe memory access in a parallel environment.</li>
<li><code>query.iter()</code> didn't actually return an iterator. It returned a <em>wrapper</em> that held an atomic lock on the component storages. The same was true for the type returned by <code>query.entity()</code></li>
<li>Removing these &quot;wrapper types&quot; would have allowed unsafe behavior because another Query could access the same components in a way that violated Rust's mutability rules.</li>
<li>Due to the iterator implementation and quirks in the rust compiler, removing the wrapper type <em>tanked</em> iteration performance by about ~2-3x.</li>
</ul>
<p>Fortunately we finally found ways to solve all of these problems. The newly added <code>QuerySets</code> allow us to completely remove the locks (and wrapper types). And by completely rewriting <code>QueryIter</code> we were able to avoid the performance hit that removing the wrapper incurred. Read on for the details!</p>
<h3 id="100-lockless-parallel-ecs">100% Lockless Parallel ECS</h3>
<p>Bevy ECS is now completely lock free. In Bevy 0.2, we made direct <code>World</code> access and &quot;for-each&quot; systems lock free. This is possible because the Bevy ECS scheduler ensures that systems only run in parallel in ways that respect Rust's mutability rules. </p>
<p>We couldn't remove locks from <code>Query</code> systems because of systems like this:</p>
<pre style="background-color:#2b2c2f;">
<code class="language-rust" data-lang="rust"><span style="color:#c594c5;">fn </span><span style="color:#6699cc;">conflicting_query_system</span><span style="color:#5fb3b3;">(</span><span style="color:#c594c5;">mut </span><span style="color:#f99157;">q0</span><span style="color:#5fb3b3;">: </span><span style="color:#cccece;">Query</span><span style="color:#5fb3b3;">&lt;&amp;</span><span style="color:#c594c5;">mut</span><span style="color:#cccece;"> A</span><span style="color:#5fb3b3;">&gt;</span><span style="color:#cccece;">, </span><span style="color:#c594c5;">mut </span><span style="color:#f99157;">q1</span><span style="color:#5fb3b3;">: </span><span style="color:#cccece;">Query</span><span style="color:#5fb3b3;">&lt;(&amp;</span><span style="color:#c594c5;">mut</span><span style="color:#cccece;"> A, </span><span style="color:#5fb3b3;">&amp;</span><span style="color:#cccece;">B</span><span style="color:#5fb3b3;">)&gt;) {
    </span><span style="color:#c594c5;">let</span><span style="color:#cccece;"> a </span><span style="color:#5fb3b3;">=</span><span style="color:#cccece;"> q0</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">get_mut</span><span style="color:#5fb3b3;">(</span><span style="color:#cccece;">some_entity</span><span style="color:#5fb3b3;">).</span><span style="color:#6699cc;">unwrap</span><span style="color:#5fb3b3;">();
    </span><span style="color:#c594c5;">let </span><span style="color:#5fb3b3;">(</span><span style="color:#cccece;">another_a</span><span style="color:#5fb3b3;">,</span><span style="color:#cccece;"> b</span><span style="color:#5fb3b3;">) =</span><span style="color:#cccece;"> q1</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">get_mut</span><span style="color:#5fb3b3;">(</span><span style="color:#cccece;">some_entity</span><span style="color:#5fb3b3;">).</span><span style="color:#6699cc;">unwrap</span><span style="color:#5fb3b3;">();
    </span><span style="color:#5f6364;">// Aaah!!! We have two mutable references to some_entity&#39;s A component!
    // Very unsafe!
</span><span style="color:#5fb3b3;">}
</span></code></pre>
<p>The locks ensured that the second <code>q1.get_mut(some_entity)</code> access panicked, keeping us nice and safe. In <strong>Bevy 0.3</strong>, a system like <code>conflicting_query_system</code> will fail when the schedule is constructed. By default, <em>systems cannot have conflicting queries</em>.</p>
<p>However there are some cases where a system <em>needs</em> conflicting queries to do what it needs to do. For these cases, we added <code>QuerySets</code>: </p>
<pre style="background-color:#2b2c2f;">
<code class="language-rust" data-lang="rust"><span style="color:#c594c5;">fn </span><span style="color:#6699cc;">system</span><span style="color:#5fb3b3;">(</span><span style="color:#c594c5;">mut </span><span style="color:#f99157;">queries</span><span style="color:#5fb3b3;">: </span><span style="color:#cccece;">QuerySet</span><span style="color:#5fb3b3;">&lt;(</span><span style="color:#cccece;">Query</span><span style="color:#5fb3b3;">&lt;&amp;</span><span style="color:#c594c5;">mut</span><span style="color:#cccece;"> A</span><span style="color:#5fb3b3;">&gt;</span><span style="color:#cccece;">, Query</span><span style="color:#5fb3b3;">&lt;(&amp;</span><span style="color:#c594c5;">mut</span><span style="color:#cccece;"> A, </span><span style="color:#5fb3b3;">&amp;</span><span style="color:#cccece;">B</span><span style="color:#5fb3b3;">)&gt;)&gt;) {
    </span><span style="color:#c594c5;">for</span><span style="color:#cccece;"> a </span><span style="color:#5fb3b3;">in</span><span style="color:#cccece;"> queries</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">q0_mut</span><span style="color:#5fb3b3;">().</span><span style="color:#6699cc;">iter_mut</span><span style="color:#5fb3b3;">() {
    }

    </span><span style="color:#c594c5;">for </span><span style="color:#5fb3b3;">(</span><span style="color:#cccece;">a</span><span style="color:#5fb3b3;">,</span><span style="color:#cccece;"> b</span><span style="color:#5fb3b3;">) in</span><span style="color:#cccece;"> queries</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">q1_mut</span><span style="color:#5fb3b3;">().</span><span style="color:#6699cc;">iter_mut</span><span style="color:#5fb3b3;">() {
    }
}
</span></code></pre>
<p>By putting our conflicting <code>Queries</code> in a <code>QuerySet</code>, the Rust borrow checker protects us from unsafe query accesses.</p>
<p>Because of this, we were able to remove <em>all</em> safety checks from <code>query.iter()</code> and <code>query.get(entity)</code>, which means these methods are now <em>exactly</em> as fast as their <code>World</code> counterparts (which we made lock-free in Bevy 0.2). </p>
<h3 id="performance-improvements">Performance Improvements</h3>
<p>Bevy had a number of nice performance improvements this release:</p>
<ul>
<li>Removed atomic locks from Query access, making Bevy ECS 100% lock free</li>
<li>Removed archetype &quot;safety checks&quot; from Query access. At this point we have already verified that the given Query access is safe, so we don't need to check again on every call.</li>
<li>Rewrote <code>QueryIter</code> to be simpler (and therefore easier to control optimizations for), which allowed us to remove the iterator wrapper without tanking performance. This also resolved some performance inconsistencies where some system permutations performed optimally and others didn't. Now everything is on the &quot;fast path&quot;!</li>
<li>Ported some performance improvements from upstream hecs, which improved iteration over heavily fragmented archetypes and improved component insertion times</li>
</ul>
<h4 id="getting-an-entity-s-component-per-100k-in-milliseconds-smaller-is-better">Getting an Entity's Component (per 100k, in milliseconds, smaller is better)</h4>
<p>Note: these numbers are for getting a component 100,000 times, not for an individual component lookup</p>
<p><img src="https://bevyengine.org/news/bevy-0-3/ecs_get_component.svg" alt="getting an entity's component" /></p>
<p>This is where the big wins were. By removing locks and safety checks from Query systems, we were able to <em>significantly</em> reduce the cost of retrieving a specific entity's component from within a system.</p>
<p>I included a comparison to <a href="https://github.com/amethyst/legion">Legion ECS</a> (another great archetypal ECS with a parallel scheduler) to illustrate why Bevy's new approach is so cool. Legion exposes a direct &quot;world like&quot; api (called a SubWorld) in its systems. The SubWorld's entry api <em>cannot</em> know ahead of time what types will be passed into it, which means it <em>must</em> do (relatively) expensive safety checks to ensure the user doesn't request access to something they shouldn't.</p>
<p>Bevy's scheduler pre-checks <code>Queries</code> once ahead of time, which allows systems to access their results without any additional checks.</p>
<p>The test was to lookup (and modify) a specific entity's component 100,000 times on each system iteration. Here is a quick rundown of how these tests were performed in each case:</p>
<ul>
<li>bevy (world): Direct <code>World</code> access using <code>world.get_mut::&lt;A&gt;(entity)</code></li>
<li>bevy (system): A system containing a <code>Query&lt;&amp;mut A&gt;</code> that accesses the component using <code>query.get_mut(entity)</code></li>
<li>legion (world): Direct <code>World</code> access using <code>let entry = world.entry(entity); entry.get_component_mut::&lt;A&gt;()</code></li>
<li>legion (system): A system with <code>SubWorld</code> access using <code>let entry = world.entry(entity); entry.get_component_mut::&lt;A&gt;()</code> </li>
</ul>
<p>It's worth noting that using <code>query.get_component::&lt;T&gt;(entity)</code> instead of <code>query.get(entity)</code> does require safety checks, for the same reason the legion entry api does. We cannot know ahead of time what component type a caller will pass into the method, which means we <em>must</em> check it to make sure it matches the <code>Query</code>. </p>
<p>Additionally, here are some relevant <a href="https://github.com/rust-gamedev/ecs_bench_suite">ecs_bench_suite</a> results (omitted benchmarks had no significant change):</p>
<h4 id="component-insertion-in-microseconds-smaller-is-better">Component Insertion (in microseconds, smaller is better)</h4>
<p><img src="https://bevyengine.org/news/bevy-0-3/ecs_simple_insert.svg" alt="component insertion" /></p>
<h4 id="component-add-remove-in-milliseconds-smaller-is-better">Component Add/Remove (in milliseconds, smaller is better)</h4>
<p><img src="https://bevyengine.org/news/bevy-0-3/ecs_add_remove.svg" alt="component add/remove" /></p>
<h4 id="fragmented-iteration-in-nanoseconds-smaller-is-better">Fragmented Iteration (in nanoseconds, smaller is better)</h4>
<p><img src="https://bevyengine.org/news/bevy-0-3/ecs_frag_iter.svg" alt="fragmented iteration" /></p>
<h3 id="thread-local-resources">Thread Local Resources</h3>
<p>Some resource types cannot (or should not) be passed between threads. This is often true for low level apis like windowing, input, and audio. It is now possible to add &quot;thread local resources&quot; to the <code>Resources</code> collection, which can only be accessed from the main thread using &quot;thread local systems&quot;:</p>
<pre style="background-color:#2b2c2f;">
<code class="language-rust" data-lang="rust"><span style="color:#5f6364;">// in your app setup
</span><span style="color:#cccece;">app</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">add_thread_local_resource</span><span style="color:#5fb3b3;">(</span><span style="color:#cccece;">MyResource</span><span style="color:#5fb3b3;">);

</span><span style="color:#5f6364;">// a thread local system
</span><span style="color:#c594c5;">fn </span><span style="color:#6699cc;">system</span><span style="color:#5fb3b3;">(</span><span style="color:#f99157;">world</span><span style="color:#5fb3b3;">: &amp;</span><span style="color:#c594c5;">mut</span><span style="color:#cccece;"> World, </span><span style="color:#f99157;">resources</span><span style="color:#5fb3b3;">: &amp;</span><span style="color:#c594c5;">mut</span><span style="color:#cccece;"> Resources</span><span style="color:#5fb3b3;">) {
    </span><span style="color:#c594c5;">let</span><span style="color:#cccece;"> my_resource </span><span style="color:#5fb3b3;">=</span><span style="color:#cccece;"> resources</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">get_thread_local</span><span style="color:#5fb3b3;">::&lt;</span><span style="color:#cccece;">MyResource</span><span style="color:#5fb3b3;">&gt;().</span><span style="color:#6699cc;">unwrap</span><span style="color:#5fb3b3;">();
}
</span></code></pre><h3 id="query-api-changes">Query Api Changes</h3>
<p>First, to improve clarity we renamed <code>query.get::&lt;Component&gt;(entity)</code> to <code>query.get_component::&lt;Component&gt;(entity)</code>. We now return the &quot;full&quot; query result for a specific entity using <code>query.get(entity)</code>.</p>
<p>To allow multiple concurrent reads of Queries (where it is safe), we added separate <code>query.iter()</code> and <code>query.iter_mut()</code> apis, as well as <code>query.get(entity)</code> and <code>query.get_mut(entity)</code>. Queries that are &quot;read only&quot; can now retrieve their results via an immutable borrow.</p>
<h2 id="mesh-improvements">Mesh Improvements</h2>
<h3 id="flexible-mesh-vertex-attributes">Flexible Mesh Vertex Attributes</h3>
<div class="release-feature-authors">authors: @julhe</div>
<p>Bevy meshes used to require exactly three &quot;vertex attributes&quot;: <code>position</code>, <code>normal</code>, and <code>uv</code>. This worked for most things, but there are a number of cases that require other attributes, such as &quot;vertex colors&quot; or &quot;bone weights for animation&quot;. <strong>Bevy 0.3</strong> adds support for custom vertex attributes. Meshes can define whatever attributes they want and shaders can consume whatever attributes they want!</p>
<p><a href="https://github.com/bevyengine/bevy/blob/v0.3.0/examples/shader/mesh_custom_attribute.rs">Here is an example</a> that illustrates how to define a custom shader that consumes a mesh with an added &quot;vertex color&quot; attribute.</p>
<p><img src="https://bevyengine.org/news/bevy-0-3/custom_vertex_attribute.png" alt="custom_vertex_attribute" /></p>
<h3 id="index-buffer-specialization">Index Buffer Specialization</h3>
<div class="release-feature-authors">authors: @termhn</div>
<p>Rendering meshes often involves using vertex &quot;indices&quot; to cut down on duplicate vertex information. Bevy used to hard code the precision of these indices to <code>u16</code>, which was too small for some cases. Now render pipelines can &quot;specialize&quot; based on a configured index buffer, which now defaults to <code>u32</code> to cover most use cases.</p>
<h2 id="transform-re-rewrite">Transform Re-Rewrite</h2>
<div class="release-feature-authors">authors: @MarekLg (with some design help from @AThilenius, @bitshifter, @termhn, and @cart)</div>
<p>Transforms are important to get right. They are used in many slices of the engine, user code touches them constantly, and they are relatively expensive to compute: especially transform hierarchies.</p>
<p>In the last release, we vastly simplified Bevy's transform system to use a consolidated <code>Transform</code> and <code>GlobalTransform</code> instead of multiple separate <code>Translation</code>, <code>Rotation</code>, and <code>Scale</code> components (which were synced to <code>Transform</code> and <code>GlobalTransform</code>). This made the user-facing api/dataflow simpler, as well as the underlying implementation. The <code>Transform</code> component was backed by a 4x4 matrix. I pressed the big green &quot;merge&quot; button ... happy that we had solved the Transform problem once and for all!</p>
<p>It turns out there was still more work to be done! <a href="https://github.com/bevyengine/bevy/issues/229#issuecomment-698953161">@AThilenius pointed out</a> that using a 4x4 matrix as the source of truth for an affine transform accumulates error over time. Additionally, the Transform api was still a little cumbersome to use. <a href="https://github.com/bevyengine/bevy/issues/229#issuecomment-699172675">At the suggestion of @termhn</a> we decided to investigate using a &quot;similarity&quot; as the source of truth. This had the following benefits:</p>
<ol>
<li>no more error accumulation</li>
<li>we could directly expose translation/rotation/scale fields, which simplified the api significantly</li>
<li>cheaper to store and cheaper to compute hierarchies in some cases</li>
</ol>
<p>We collectively decided this was a good path forward and now we have a re-rewrite that is even better. Yes this is <em>another</em> breaking change, but thats why we label Bevy as being in the &quot;experimentation phase&quot;. Now is the time to break things as often as possible to ensure that we find good apis that will stand the test of time.</p>
<p>This is what the new <code>Transform</code> api looks like in a Bevy ECS system:</p>
<pre style="background-color:#2b2c2f;">
<code class="language-rust" data-lang="rust"><span style="color:#c594c5;">fn </span><span style="color:#6699cc;">system</span><span style="color:#5fb3b3;">(</span><span style="color:#c594c5;">mut </span><span style="color:#f99157;">transform</span><span style="color:#5fb3b3;">: </span><span style="color:#cccece;">Mut</span><span style="color:#5fb3b3;">&lt;</span><span style="color:#cccece;">Transform</span><span style="color:#5fb3b3;">&gt;) {
    </span><span style="color:#5f6364;">// move along the positive x-axis
</span><span style="color:#cccece;">    transform</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">translation </span><span style="color:#5fb3b3;">+= </span><span style="color:#cccece;">Vec3</span><span style="color:#5fb3b3;">::</span><span style="color:#cccece;">new</span><span style="color:#5fb3b3;">(</span><span style="color:#f99157;">1.0</span><span style="color:#5fb3b3;">, </span><span style="color:#f99157;">0.0</span><span style="color:#5fb3b3;">, </span><span style="color:#f99157;">0.0</span><span style="color:#5fb3b3;">);

    </span><span style="color:#5f6364;">// rotate 180 degrees (pi) around the y-axis
</span><span style="color:#cccece;">    transform</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">rotation </span><span style="color:#5fb3b3;">*= </span><span style="color:#cccece;">Quat</span><span style="color:#5fb3b3;">::</span><span style="color:#cccece;">from_rotation_y</span><span style="color:#5fb3b3;">(</span><span style="color:#cccece;">PI</span><span style="color:#5fb3b3;">);

    </span><span style="color:#5f6364;">// scale 2x
</span><span style="color:#cccece;">    transform</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">scale </span><span style="color:#5fb3b3;">*= </span><span style="color:#f99157;">2.0</span><span style="color:#5fb3b3;">;
}
</span></code></pre>
<p>Compared to the last version this is easier to use, more correct, and should also be slightly faster.</p>
<h2 id="gamepad-settings">Gamepad Settings</h2>
<div class="release-feature-authors">authors: @simpuid</div>
<p>The newly added <code>GamepadSettings</code> resource gives developers the ability to customize gamepad settings on a per-controller, per-axis/button basis:</p>
<pre style="background-color:#2b2c2f;">
<code class="language-rust" data-lang="rust"><span style="color:#c594c5;">fn </span><span style="color:#6699cc;">system</span><span style="color:#5fb3b3;">(</span><span style="color:#c594c5;">mut </span><span style="color:#f99157;">gamepad_settings</span><span style="color:#5fb3b3;">: </span><span style="color:#cccece;">ResMut</span><span style="color:#5fb3b3;">&lt;</span><span style="color:#cccece;">GamepadSettings</span><span style="color:#5fb3b3;">&gt;) {
</span><span style="color:#cccece;">    gamepad_settings</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">axis_settings</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">insert</span><span style="color:#5fb3b3;">(
</span><span style="color:#cccece;">        GamepadAxis</span><span style="color:#5fb3b3;">(</span><span style="color:#cccece;">Gamepad</span><span style="color:#5fb3b3;">(</span><span style="color:#f99157;">0</span><span style="color:#5fb3b3;">), </span><span style="color:#cccece;">GamepadAxisType</span><span style="color:#5fb3b3;">::</span><span style="color:#cccece;">LeftStickX</span><span style="color:#5fb3b3;">),
</span><span style="color:#cccece;">        AxisSettings </span><span style="color:#5fb3b3;">{
</span><span style="color:#cccece;">            positive_high</span><span style="color:#5fb3b3;">: </span><span style="color:#f99157;">0.8</span><span style="color:#5fb3b3;">,
</span><span style="color:#cccece;">            positive_low</span><span style="color:#5fb3b3;">: </span><span style="color:#f99157;">0.01</span><span style="color:#5fb3b3;">,
            ..</span><span style="color:#fac863;">Default</span><span style="color:#5fb3b3;">::</span><span style="color:#cccece;">default</span><span style="color:#5fb3b3;">()
        },
    );
}
</span></code></pre><h2 id="plugin-groups">Plugin Groups</h2>
<div class="release-feature-authors">authors: @cart</div>
<p>If you've used Bevy, you're probably familiar with this part of <code>App</code> initialization:</p>
<pre style="background-color:#2b2c2f;">
<code class="language-rust" data-lang="rust"><span style="color:#cccece;">app</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">add_default_plugins</span><span style="color:#5fb3b3;">();
</span></code></pre>
<p>This adds the plugins for all of the &quot;core&quot; engine functionality (rendering, input, audio, windowing, etc). It was straightforward, but also very static. What if you don't want to add <em>all</em> of the default plugins? What if you want to create your own custom set of plugins?</p>
<p>To resolve this, we added <code>PluginGroups</code>, which are ordered collections of plugins that can be individually enabled or disabled:</p>
<pre style="background-color:#2b2c2f;">
<code class="language-rust" data-lang="rust"><span style="color:#5f6364;">// This:
</span><span style="color:#cccece;">app</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">add_default_plugins</span><span style="color:#5fb3b3;">()

</span><span style="color:#5f6364;">// Has been replaced by this:
</span><span style="color:#cccece;">app</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">add_plugins</span><span style="color:#5fb3b3;">(</span><span style="color:#cccece;">DefaultPlugins</span><span style="color:#5fb3b3;">)

</span><span style="color:#5f6364;">// You can disable specific plugins in a PluginGroup:
</span><span style="color:#cccece;">app</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">add_plugins_with</span><span style="color:#5fb3b3;">(</span><span style="color:#cccece;">DefaultPlugins</span><span style="color:#5fb3b3;">, |</span><span style="color:#f99157;">group</span><span style="color:#5fb3b3;">| {
</span><span style="color:#cccece;">    group</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">disable</span><span style="color:#5fb3b3;">::&lt;</span><span style="color:#cccece;">RenderPlugin</span><span style="color:#5fb3b3;">&gt;()
         .</span><span style="color:#cccece;">disable</span><span style="color:#5fb3b3;">::&lt;</span><span style="color:#cccece;">AudioPlugin</span><span style="color:#5fb3b3;">&gt;()
});

</span><span style="color:#5f6364;">// And you can create your own PluginGroups:
</span><span style="color:#c594c5;">pub struct </span><span style="color:#cccece;">HelloWorldPlugins</span><span style="color:#5fb3b3;">;

</span><span style="color:#c594c5;">impl </span><span style="color:#cccece;">PluginGroup </span><span style="color:#c594c5;">for </span><span style="color:#cccece;">HelloWorldPlugins </span><span style="color:#5fb3b3;">{
    </span><span style="color:#c594c5;">fn </span><span style="color:#6699cc;">build</span><span style="color:#5fb3b3;">(&amp;</span><span style="color:#c594c5;">mut </span><span style="color:#f99157;">self</span><span style="color:#cccece;">, </span><span style="color:#f99157;">group</span><span style="color:#5fb3b3;">: &amp;</span><span style="color:#c594c5;">mut</span><span style="color:#cccece;"> PluginGroupBuilder</span><span style="color:#5fb3b3;">) {
</span><span style="color:#cccece;">        group</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">add</span><span style="color:#5fb3b3;">(</span><span style="color:#cccece;">PrintHelloPlugin</span><span style="color:#5fb3b3;">)
             .</span><span style="color:#6699cc;">add</span><span style="color:#5fb3b3;">(</span><span style="color:#cccece;">PrintWorldPlugin</span><span style="color:#5fb3b3;">);
    }
}

</span><span style="color:#cccece;">app</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">add_plugins</span><span style="color:#5fb3b3;">(</span><span style="color:#cccece;">HelloWorldPlugins</span><span style="color:#5fb3b3;">);
</span></code></pre><h2 id="dynamic-window-settings">Dynamic Window Settings</h2>
<div class="release-feature-authors">authors: @mockersf</div>
<p>Bevy provides a backend-agnostic windowing api. Up until this point, window settings could only be set once at app startup. If you wanted to set window settings dynamically, you had to directly interact with window backends (ex: winit).</p>
<p>In this release we added the ability to dynamically set window properties at runtime using the Bevy window abstraction:</p>
<pre style="background-color:#2b2c2f;">
<code class="language-rust" data-lang="rust"><span style="color:#5f6364;">// This system dynamically sets the window title to the number of seconds since startup. Because why not?
</span><span style="color:#c594c5;">fn </span><span style="color:#6699cc;">change_title</span><span style="color:#5fb3b3;">(</span><span style="color:#f99157;">time</span><span style="color:#5fb3b3;">: </span><span style="color:#cccece;">Res</span><span style="color:#5fb3b3;">&lt;</span><span style="color:#cccece;">Time</span><span style="color:#5fb3b3;">&gt;</span><span style="color:#cccece;">, </span><span style="color:#c594c5;">mut </span><span style="color:#f99157;">windows</span><span style="color:#5fb3b3;">: </span><span style="color:#cccece;">ResMut</span><span style="color:#5fb3b3;">&lt;</span><span style="color:#cccece;">Windows</span><span style="color:#5fb3b3;">&gt;) {
    </span><span style="color:#c594c5;">let</span><span style="color:#cccece;"> window </span><span style="color:#5fb3b3;">=</span><span style="color:#cccece;"> windows</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">get_primary_mut</span><span style="color:#5fb3b3;">().</span><span style="color:#6699cc;">unwrap</span><span style="color:#5fb3b3;">();
</span><span style="color:#cccece;">    window</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">set_title</span><span style="color:#5fb3b3;">(</span><span style="color:#cccece;">format!</span><span style="color:#5fb3b3;">(
        &quot;</span><span style="color:#99c794;">Seconds since startup: {}</span><span style="color:#5fb3b3;">&quot;,</span><span style="color:#cccece;"> time</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">seconds_since_startup
    </span><span style="color:#5fb3b3;">));
}
</span></code></pre><h2 id="documentation-search-ability">Documentation Search-ability</h2>
<div class="release-feature-authors">authors: @memoryruins</div>
<p>The  <code>bevy</code> crate documentation search function now returns results for all sub-crates (like bevy_sprite). Due to how documentation is generated for re-exported crates, by default the <code>bevy</code> search index only covered the &quot;prelude&quot;. @memoryruins found a way to fix this problem by creating new modules and exporting the contents of each crate within those modules (as opposed to aliasing the crates).</p>
<p><img src="https://bevyengine.org/news/bevy-0-3/docs.png" alt="docs" /></p>
<h2 id="change-log">Change Log</h2>
<h3 id="added">Added</h3>
<ul>
<li><a href="https://github.com/bevyengine/bevy/pull/696">Touch Input</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/539">iOS XCode Project</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/740">Android Example and use bevy-glsl-to-spirv 0.2.0</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/679">Introduce Mouse capture API</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/696"><code>bevy_input::touch</code>: implement touch input</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/653">D-pad support on MacOS</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/723">Support for Android file system</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/744">app: PluginGroups and DefaultPlugins</a>
<ul>
<li><code>PluginGroup</code> is a collection of plugins where each plugin can be enabled or disabled.</li>
</ul>
</li>
<li><a href="https://github.com/bevyengine/bevy/pull/683">Support to get gamepad button/trigger values using <code>Axis&lt;GamepadButton&gt;</code></a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/627">Expose Winit decorations</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/644">Enable changing window settings at runtime</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/674">Expose a pointer of EventLoopProxy to process custom messages</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/460">Add a way to specify padding/ margins between sprites in a TextureAtlas</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/579">Add <code>bevy_ecs::Commands::remove</code> for bundles</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/675">impl <code>Default</code> for <code>TextureFormat</code></a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/595">Expose current_entity in ChildBuilder</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/671"><code>AppBuilder::add_thread_local_resource</code></a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/661"><code>Commands::write_world_boxed</code> takes a pre-boxed world writer to the ECS's command queue</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/678"><code>FrameTimeDiagnosticsPlugin</code> now shows &quot;frame count&quot; in addition to &quot;frame time&quot; and &quot;fps&quot;</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/565">Add hierarchy example</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/397"><code>WgpuPowerOptions</code> for choosing between low power, high performance, and adaptive power</a></li>
<li>Derive <code>Debug</code> for more types: <a href="https://github.com/bevyengine/bevy/pull/597">#597</a>, <a href="https://github.com/bevyengine/bevy/pull/632">#632</a> </li>
<li>Index buffer specialization
<ul>
<li><a href="https://github.com/bevyengine/bevy/pull/568">Allows the use of U32 indices in Mesh index buffers in addition to the usual U16 indices</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/572">Switch to u32 indices by default</a></li>
</ul>
</li>
<li>More instructions for system dependencies
<ul>
<li><a href="https://github.com/bevyengine/bevy/pull/528">Add <code>systemd-devel</code> for Fedora Linux dependencies</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/538">Add <code>libudev-dev</code> to Ubuntu dependencies</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/645">Add Void Linux to linux dependencies file</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/727">WSL2 instructions</a></li>
</ul>
</li>
<li><a href="https://github.com/bevyengine/bevy/pull/552">Suggest <code>-Zrun-dsymutil-no</code> for faster compilation on MacOS</a></li>
</ul>
<h3 id="changed">Changed</h3>
<ul>
<li><a href="https://github.com/bevyengine/bevy/pull/741">ecs: ergonomic query.iter(), remove locks, add QuerySets</a>
<ul>
<li><code>query.iter()</code> is now a real iterator!</li>
<li><code>QuerySet</code> allows working with conflicting queries and is checked at compile-time.</li>
</ul>
</li>
<li><a href="https://github.com/bevyengine/bevy/pull/752">Rename <code>query.entity()</code> and <code>query.get()</code></a>
<ul>
<li><code>query.get::&lt;Component&gt;(entity)</code> is now <code>query.get_component::&lt;Component&gt;(entity)</code></li>
<li><code>query.entity(entity)</code> is now <code>query.get(entity)</code></li>
</ul>
</li>
<li><a href="https://github.com/bevyengine/bevy/pull/693">Asset system rework and GLTF scene loading</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/703">Introduces WASM implementation of <code>AssetIo</code></a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/596">Move transform data out of Mat4</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/700">Separate gamepad state code from gamepad event code and other customizations</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/711">gamepad: expose raw and filtered gamepad events</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/689">Do not depend on <code>spirv-reflect</code> on <code>wasm32</code> target</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/544">Move dynamic plugin loading to its own optional crate</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/515">Add field to <code>WindowDescriptor</code> on wasm32 targets to optionally provide an existing canvas element as winit window</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/660">Adjust how <code>ArchetypeAccess</code> tracks mutable &amp; immutable deps</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/535">Use <code>FnOnce</code> in <code>Commands</code> and <code>ChildBuilder</code> where possible</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/690">Runners explicitly call <code>App.initialize()</code></a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/616">sRGB awareness for <code>Color</code></a>
<ul>
<li>Color is now assumed to be provided in the non-linear sRGB colorspace.
Constructors such as <code>Color::rgb</code> and <code>Color::rgba</code> will be converted to linear sRGB.</li>
<li>New methods <code>Color::rgb_linear</code> and <code>Color::rgba_linear</code> will accept colors already in linear sRGB (the old behavior)</li>
<li>Individual color-components must now be accessed through setters and getters.</li>
</ul>
</li>
<li><a href="https://github.com/bevyengine/bevy/pull/599"><code>Mesh</code> overhaul with custom vertex attributes</a>
<ul>
<li>Any vertex attribute can now be added over <code>mesh.attributes.insert()</code>.</li>
<li>See <code>example/shader/mesh_custom_attribute.rs</code></li>
<li>Removed <code>VertexAttribute</code>, <code>Vertex</code>, <code>AsVertexBufferDescriptor</code>.</li>
<li>For missing attributes (requested by shader, but not defined by mesh), Bevy will provide a zero-filled fallback buffer.</li>
</ul>
</li>
<li>Despawning an entity multiple times causes a debug-level log message to be emitted instead of a panic: <a href="https://github.com/bevyengine/bevy/pull/649">#649</a>, <a href="https://github.com/bevyengine/bevy/pull/651">#651</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/692">Migrated to Rodio 0.12</a>
<ul>
<li>New method of playing audio can be found in the examples.</li>
</ul>
</li>
<li>Added support for inserting custom initial values for <code>Local&lt;T&gt;</code> system resources <a href="https://github.com/bevyengine/bevy/pull/745">#745</a> </li>
</ul>
<h3 id="fixed">Fixed</h3>
<ul>
<li><a href="https://github.com/bevyengine/bevy/pull/560">Properly update bind group ids when setting dynamic bindings</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/610">Properly exit the app on AppExit event</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/618">Fix FloatOrd hash being different for different NaN values</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/543">Fix Added behavior for QueryOne get</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/488">Update camera_system to fix issue with late camera addition</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/664">Register <code>IndexFormat</code> as a property</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/685">Fix breakout example bug</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/713">Fix PreviousParent lag by merging parent update systems</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/730">Fix bug of connection event of gamepad at startup</a></li>
<li><a href="https://github.com/bevyengine/bevy/pull/725">Fix wavy text</a></li>
</ul>
<h2 id="contributors">Contributors</h2>
<p>A huge thanks to the <strong>59 contributors</strong> that made this release (and associated docs) possible!</p>
<ul>
<li>alec-deason</li>
<li>alexb910</li>
<li>andrewhickman</li>
<li>blunted2night</li>
<li>Bobox214</li>
<li>cart</li>
<li>CGMossa</li>
<li>CleanCut</li>
<li>ColdIce1605</li>
<li>Cupnfish</li>
<li>Dash-L</li>
<li>DJMcNab</li>
<li>EllenNyan</li>
<li>enfipy</li>
<li>EthanYidong</li>
<li>Gregoor</li>
<li>HyperLightKitsune</li>
<li>ian-h-chamberlain </li>
<li>J-F-Liu</li>
<li>Jerald</li>
<li>jngbsn</li>
<li>joshuajbouw</li>
<li>julhe</li>
<li>kedodrill</li>
<li>lberrymage</li>
<li>lee-orr</li>
<li>liufuyang</li>
<li>MarekLg</li>
<li>Mautar55</li>
<li>memoryruins</li>
<li>mjhostet</li>
<li>mockersf</li>
<li>MrEmanuel</li>
<li>mrk-its</li>
<li>mtsr</li>
<li>naithar</li>
<li>navaati</li>
<li>ndarilek</li>
<li>nic96</li>
<li>ocornoc</li>
<li>Olaren15</li>
<li>PrototypeNM1</li>
<li>Ratysz</li>
<li>Raymond26</li>
<li>robertwayne</li>
<li>simlay</li>
<li>simpuid</li>
<li>smokku</li>
<li>stjepang</li>
<li>SvenTS</li>
<li>sY9sE33</li>
<li>termhn</li>
<li>tigregalis</li>
<li>Vaelint</li>
<li>W4RH4WK</li>
<li>walterpie</li>
<li>will-hart</li>
<li>zgotsch</li>
<li>Zooce</li>
</ul>
</div>
</div>

            </div>
        </section>
    </body>
</html>
